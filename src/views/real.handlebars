<h1 class="text-center bg-success-subtle p-2 text-dark-emphasis bg-opacity-25 fst-italic">The Baby's Shop</h1>
<section>
    <article class="w-75 align-items-center d-flex flex-column">
        <h2 class="text-center">REGISTER FORM!</h2>

        <form class="d-flex flex-column w-50 ">
            <input class="m-2" type="text" name="photo" id="photo" placeholder="PHOTO">
            <input class="m-2" type="title" name="title" id="title" placeholder="TITLE">
            <input class="m-2" type="category" name="category" id="category" placeholder="CATEGORY">
            <input class="m-2" type="price" name="price" id="price" placeholder="PRICE">
            <input class="m-2" type="stock" name="stock" id="stock" placeholder="STOCK">
            <input class="m-2" type="button" id="Register" value="REGISTER!">
        </form>
    </article>
    <div id="products-container" class="d-flex flex-wrap w-50">
        {{!-- aca se agregan los productos nuevos --}}
    </div>
</section>

<script>
    document.querySelector("#register").addEventListener("click", async () => {
        const data = {
            photo: document.querySelector("#photo").value,
            title: document.querySelector("#title").value,
            category: document.querySelector("#category").value,
            price: document.querySelector("#price").value,
            stock: document.querySelector("#stock").value
        }

        const photoValue = document.querySelector("#photo").value;
        if (photoValue) {
            data.photo = photoValue;
        }

        const opts = {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(data)
        }

        let response = await fetch("/api/products", opts)
        response = await response.json()

        console.log(response)

        if (response.statusCode === 201) {
            alert("Product created successfully")
            // Crear una nueva tarjeta para el producto
            const productCard = document.createElement("div");
            productCard.className = "card m-2";
            productCard.innerHTML = `
            <img src="${data.photo}" class="card-img-top" alt="${data.title}">
            <div class="card-body d-flex flex-column">
                <h5 class="card-title">${data.title}</h5>
                <p class="card-text">Category: ${data.category}</p>
                <div class="card-body d-flex justify-content-around p-0">
                <strong class="card-text">Price: $${data.price}</strong>
                <strong class="card-text">Stock: ${data.stock}</strong>
            </div>`;
            // Agregar la tarjeta al contenedor de productos
            document.querySelector("#products-container").appendChild(productCard);
        } else {
            alert(response.message)
        }
    })
</script>